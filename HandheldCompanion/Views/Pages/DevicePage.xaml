<Page
    x:Class="HandheldCompanion.Views.Pages.DevicePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:colorpicker="clr-namespace:ColorPicker;assembly=ColorPicker"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:emoji="http://schemas.inkore.net/lib/ui/wpf/emojis"
    xmlns:ikw="http://schemas.inkore.net/lib/ui/wpf"
    xmlns:l="clr-namespace:HandheldCompanion.Localization"
    xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:resx="clr-namespace:HandheldCompanion.Properties"
    xmlns:ui="http://schemas.inkore.net/lib/ui/wpf/modern"
    xmlns:viewmodels="clr-namespace:HandheldCompanion.ViewModels"
    Name="Device"
    Title="{l:Static resx:Resources.DevicePage_Device}"
    d:Background="White"
    d:DataContext="{d:DesignInstance Type=viewmodels:DevicePageViewModel}"
    d:DesignHeight="2200"
    d:DesignWidth="1000"
    KeepAlive="True"
    Loaded="Page_Loaded"
    mc:Ignorable="d">

    <Grid Name="MainGrid" Margin="20">
        <ikw:SimpleStackPanel Spacing="8">
            <!--  Power options  -->
            <TextBlock Style="{StaticResource BaseTextBlockStyle}" Text="{l:Static resx:Resources.DevicePage_PowerOptions}" />
            <ikw:SimpleStackPanel Name="PowerOptionsStack" Spacing="3">
                <ui:SettingsCard
                    HorizontalContentAlignment="Stretch"
                    Description="{l:Static resx:Resources.DevicePage_TDPControlMethodDesc}"
                    Header="{l:Static resx:Resources.DevicePage_TDPControlMethod}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xea86;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ComboBox SelectedIndex="{Binding ConfigurableTDPMethod, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        <ComboBoxItem>Default</ComboBoxItem>
                        <ComboBoxItem IsEnabled="{Binding HasWMIMethod, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}">WMI</ComboBoxItem>
                    </ComboBox>
                </ui:SettingsCard>

                <!--  Configurable TDP  -->
                <ui:SettingsCard Description="{l:Static resx:Resources.SettingsPage_TDPRangeOverrideDesc}" Header="{l:Static resx:Resources.SettingsPage_TDPRangeOverride}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xe785;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ui:ToggleSwitch Name="Toggle_cTDP" Toggled="Toggle_cTDP_Toggled" />
                </ui:SettingsCard>

                <!--  Configurable TDP down  -->
                <ui:SettingsCard
                    d:Visibility="Visible"
                    Description="{l:Static resx:Resources.SettingsPage_TDPMinDesc}"
                    Header="{l:Static resx:Resources.SettingsPage_TDPMin}"
                    Visibility="{Binding ElementName=Toggle_cTDP, Path=IsOn, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xE713;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ui:NumberBox
                        Name="NumberBox_TDPMin"
                        MinWidth="20"
                        Minimum="3"
                        SpinButtonPlacementMode="Inline"
                        ValueChanged="NumberBox_TDPMin_ValueChanged" />
                </ui:SettingsCard>

                <!--  Configurable TDP up  -->
                <ui:SettingsCard
                    d:Visibility="Visible"
                    Description="{l:Static resx:Resources.SettingsPage_TDPMaxDesc}"
                    Header="{l:Static resx:Resources.SettingsPage_TDPMax}"
                    Visibility="{Binding ElementName=Toggle_cTDP, Path=IsOn, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xE713;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ui:NumberBox
                        Name="NumberBox_TDPMax"
                        MinWidth="20"
                        Maximum="75"
                        SpinButtonPlacementMode="Inline"
                        ValueChanged="NumberBox_TDPMax_ValueChanged" />
                </ui:SettingsCard>
            </ikw:SimpleStackPanel>

            <!--  Security options  -->
            <TextBlock Style="{StaticResource BaseTextBlockStyle}" Text="{l:Static resx:Resources.DevicePage_SecurityOptions}" />
            <ikw:SimpleStackPanel Name="SecurityOptionsStack" Spacing="3">

                <!--  Core isolation  -->
                <ui:SettingsCard Description="{l:Static resx:Resources.DevicePage_CoreIsolationDesc}" Header="{l:Static resx:Resources.DevicePage_CoreIsolation}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xE705;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ui:ToggleSwitch IsOn="{Binding MemoryIntegrity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                </ui:SettingsCard>
            </ikw:SimpleStackPanel>

            <!--  Platform options  -->
            <TextBlock Style="{StaticResource BaseTextBlockStyle}" Text="{l:Static resx:Resources.DevicePage_PlatformOptions}" />
            <ikw:SimpleStackPanel Name="PlatformOptionsStack" Spacing="3">

                <!--  OEM Frontend  -->
                <ui:SettingsCard
                    Description="{l:Static resx:Resources.DevicePage_ManufacturerApplicationDesc}"
                    Header="{l:Static resx:Resources.DevicePage_ManufacturerApplication}"
                    IsEnabled="{Binding HasManufacturerPlatform}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xF156;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ToggleButton IsChecked="{Binding ManufacturerAppStatus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding ManufacturerAppBusy, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}">
                        <ToggleButton.Style>
                            <Style BasedOn="{StaticResource DefaultToggleButtonStyle}" TargetType="ToggleButton">
                                <Setter Property="Content" Value="Restore" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ManufacturerAppStatus}" Value="True">
                                        <Setter Property="Content" Value="Disable" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ToggleButton.Style>
                    </ToggleButton>
                </ui:SettingsCard>

                <ui:ProgressBar IsIndeterminate="True" Visibility="{Binding ManufacturerAppBusy, Mode=OneWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=False}" />
            </ikw:SimpleStackPanel>

            <!--  Battery options  -->
            <ikw:SimpleStackPanel
                Name="BatteryChargeStack"
                d:Visibility="Visible"
                Spacing="3"
                Visibility="{Binding BatteryBypassVisibility, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}">

                <TextBlock Style="{StaticResource BaseTextBlockStyle}" Text="{l:Static resx:Resources.DevicePage_BatteryOptions}" />
                <!--  Battery Charge  -->
                <ui:SettingsCard
                    Name="BatteryChargeLimitToggle"
                    Description="{l:Static resx:Resources.DevicePage_BatteryChargeLimit_Desc}"
                    Header="{l:Static resx:Resources.DevicePage_BatteryChargeLimit}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xebb2;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ui:ToggleSwitch Name="Toggle_BatteryChargeLimit" Toggled="Toggle_BatteryChargeLimit_Toggled" />
                </ui:SettingsCard>

                <ui:SettingsCard
                    Name="BatteryChargeLimitPercent"
                    Description="{l:Static resx:Resources.DevicePage_BatteryChargeLimitPercent_Desc}"
                    Header="{l:Static resx:Resources.DevicePage_BatteryChargeLimitPercent}"
                    IsEnabled="{Binding BatteryChargeLimitPercent, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xE713;" />
                    </ui:SettingsCard.HeaderIcon>
                    <DockPanel>
                        <Label
                            VerticalAlignment="Center"
                            Content="{Binding Value, StringFormat={}{0:N0}%, Source={x:Reference Slider_BatteryChargeLimitPercent}, Mode=OneWay}"
                            Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" />
                        <Slider
                            x:Name="Slider_BatteryChargeLimitPercent"
                            Width="200"
                            IsMoveToPointEnabled="True"
                            IsSnapToTickEnabled="True"
                            LargeChange="{Binding BatteryBypassStep, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                            Maximum="{Binding BatteryBypassMax, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                            Minimum="{Binding BatteryBypassMin, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                            SmallChange="{Binding BatteryBypassStep, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                            TickFrequency="{Binding BatteryBypassStep, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                            TickPlacement="BottomRight"
                            ToolTip="{Binding Value, StringFormat=N0, RelativeSource={RelativeSource Self}, Mode=OneWay}"
                            ValueChanged="Slider_BatteryChargeLimitPercent_OnValueChanged"
                            Value="100" />
                    </DockPanel>
                </ui:SettingsCard>
                <ui:SettingsCard
                    Name="BatteryBypassCharging"
                    d:Visibility="Visible"
                    Description="{l:Static resx:Resources.DevicePage_BatteryBypassCharging_Desc}"
                    Header="{l:Static resx:Resources.DevicePage_BatteryBypassCharging}"
                    Visibility="{Binding BatteryBypassModeVisibility, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xE713;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ComboBox Name="CB_BatteryBypassCharging" SelectionChanged="CB_BatteryBypassCharging_OnSelectionChanged">
                        <ComboBox.ItemTemplate>
                            <ItemContainerTemplate>
                                <WrapPanel>
                                    <TextBlock
                                        Height="25"
                                        Margin="10,6,0,0"
                                        Text="{Binding DisplayName}" />
                                </WrapPanel>
                            </ItemContainerTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </ui:SettingsCard>
            </ikw:SimpleStackPanel>

            <!--  Dynamic lighting settings  -->
            <ikw:SimpleStackPanel
                Name="DynamicLightingPanel"
                d:Visibility="Visible"
                Spacing="3"
                Visibility="Collapsed">
                <TextBlock Style="{StaticResource BaseTextBlockStyle}" Text="{l:Static resx:Resources.DevicePage_DynamicLightTitle}" />

                <!--  Use Dynamic lighting  -->
                <ui:SettingsCard Header="{l:Static resx:Resources.DevicePage_DynamicLightDesc}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xE781;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ui:ToggleSwitch Name="UseDynamicLightingToggle" Toggled="UseDynamicLightingToggle_Toggled" />
                </ui:SettingsCard>

                <ikw:SimpleStackPanel
                    Name="LEDPanel"
                    IsEnabled="{Binding ElementName=UseDynamicLightingToggle, Path=IsOn}"
                    Spacing="3">
                    <!--  Static LED Brightness  -->
                    <ui:SettingsCard
                        Name="LEDBrightness"
                        Description="{l:Static resx:Resources.DevicePage_DynamicLighting_BrightnessDesc}"
                        Header="{l:Static resx:Resources.DevicePage_DynamicLighting_Brightness}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Glyph="&#xE706;" />
                        </ui:SettingsCard.HeaderIcon>
                        <DockPanel Grid.Column="1" Margin="12,0,0,0">
                            <Label
                                VerticalAlignment="Center"
                                Content="{Binding Value, StringFormat={}{0:N0}%, Source={x:Reference SliderLEDBrightness}, Mode=OneWay}"
                                Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" />
                            <Slider
                                x:Name="SliderLEDBrightness"
                                Width="200"
                                Margin="6,0,0,0"
                                VerticalAlignment="Center"
                                IsMoveToPointEnabled="True"
                                IsSnapToTickEnabled="True"
                                LargeChange="10"
                                Maximum="100"
                                Minimum="0"
                                SmallChange="5"
                                TickFrequency="5"
                                TickPlacement="BottomRight"
                                ToolTip="{Binding Value, StringFormat=N0, RelativeSource={RelativeSource Self}, Mode=OneWay}"
                                ValueChanged="SliderLEDBrightness_ValueChanged"
                                Value="100" />
                        </DockPanel>
                    </ui:SettingsCard>

                    <!--  Dynamic lighting effects  -->
                    <ui:SettingsExpander
                        Name="DynamicLightingEffects"
                        Description="{l:Static resx:Resources.DevicePage_DynamicLightingDesc}"
                        Expanded="Expander_Expanded"
                        Header="{l:Static resx:Resources.DevicePage_DynamicLighting}">
                        <ui:SettingsExpander.HeaderIcon>
                            <ui:FontIcon Glyph="&#xF4A5;" />
                        </ui:SettingsExpander.HeaderIcon>
                        <ComboBox
                            Name="LEDSettingsLevel"
                            Width="220"
                            SelectionChanged="LEDSettingsLevel_SelectionChanged">

                            <ComboBoxItem
                                Name="LEDSolidColor"
                                Content="{l:Static resx:Resources.DevicePage_DynamicLighting_SolidColor}"
                                IsEnabled="False"
                                Tag="1"
                                Visibility="Collapsed" />
                            <ComboBoxItem
                                Name="LEDBreathing"
                                Content="{l:Static resx:Resources.DevicePage_DynamicLighting_Breathing}"
                                IsEnabled="False"
                                Tag="2"
                                Visibility="Collapsed" />
                            <ComboBoxItem
                                Name="LEDRainbow"
                                Content="{l:Static resx:Resources.DevicePage_DynamicLighting_Rainbow}"
                                IsEnabled="False"
                                Tag="4"
                                Visibility="Collapsed" />
                            <ComboBoxItem
                                Name="LEDWave"
                                Content="{l:Static resx:Resources.DevicePage_DynamicLighting_Wave}"
                                IsEnabled="False"
                                Tag="8"
                                Visibility="Collapsed" />
                            <ComboBoxItem
                                Name="LEDWheel"
                                Content="{l:Static resx:Resources.DevicePage_DynamicLighting_Wheel}"
                                IsEnabled="False"
                                Tag="16"
                                Visibility="Collapsed" />
                            <ComboBoxItem
                                Name="LEDGradient"
                                Content="{l:Static resx:Resources.DevicePage_DynamicLighting_Gradient}"
                                IsEnabled="False"
                                Tag="32"
                                Visibility="Collapsed" />
                            <ComboBoxItem
                                Name="LEDAmbilight"
                                Content="{l:Static resx:Resources.DevicePage_DynamicLighting_Ambilight}"
                                IsEnabled="False"
                                Tag="64"
                                Visibility="Collapsed" />
                            <ComboBoxItem
                                Name="LEDPreset"
                                Content="{l:Static resx:Resources.DevicePage_DynamicLighting_Presets}"
                                IsEnabled="False"
                                Tag="128"
                                Visibility="Collapsed" />
                        </ComboBox>
                        <ui:SettingsExpander.Items>
                            <!--  Effect speed  -->
                            <ui:SettingsCard
                                d:Visibility="Visible"
                                Header="{l:Static resx:Resources.DevicePage_DynamicLighting_EffectSpeed}"
                                Visibility="{Binding Source={x:Reference LEDSettingsLevel}, Path=SelectedIndex, Converter={StaticResource IndexToVisibilityConverter}, ConverterParameter=1|2|3|4|5|6}">
                                <DockPanel>
                                    <Label
                                        VerticalAlignment="Center"
                                        Content="{Binding Value, StringFormat={}{0:N0}%, Source={x:Reference SliderLEDSpeed}, Mode=OneWay}"
                                        Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" />
                                    <Slider
                                        x:Name="SliderLEDSpeed"
                                        Width="200"
                                        Margin="6,0,0,0"
                                        VerticalAlignment="Center"
                                        IsMoveToPointEnabled="True"
                                        IsSnapToTickEnabled="True"
                                        LargeChange="10"
                                        Maximum="100"
                                        Minimum="10"
                                        SmallChange="5"
                                        TickFrequency="5"
                                        TickPlacement="BottomRight"
                                        ToolTip="{Binding Value, StringFormat=N0, RelativeSource={RelativeSource Self}, Mode=OneWay}"
                                        ValueChanged="SliderLEDSpeed_ValueChanged"
                                        Value="100" />
                                </DockPanel>
                            </ui:SettingsCard>
                            <!--  Direction  -->
                            <!--  Visibility="{Binding Source={x:Reference LEDSettingsLevel}, Path=SelectedIndex, Converter={StaticResource IndexToVisibilityConverter}, ConverterParameter=2|3|4|5}"  -->
                            <ui:SettingsCard
                                d:Visibility="Visible"
                                Header="{l:Static resx:Resources.DevicePage_DynamicLighting_EffectDirection}"
                                Visibility="Collapsed">
                                <DockPanel>
                                    <ComboBox
                                        Name="LEDDirection"
                                        Grid.Column="1"
                                        Margin="12,0,0,0"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"
                                        SelectedIndex="0"
                                        SelectionChanged="LEDDirection_SelectionChanged" />
                                </DockPanel>
                            </ui:SettingsCard>

                            <!--  Main color  -->
                            <!--  Match my Windows accent color  -->
                            <ui:SettingsCard
                                d:Visibility="Visible"
                                Header="{l:Static resx:Resources.DevicePage_DynamicLighting_MatchAccentColor}"
                                Visibility="{Binding Source={x:Reference LEDSettingsLevel}, Path=SelectedIndex, Converter={StaticResource IndexToVisibilityConverter}, ConverterParameter=0|1|3|5}">
                                <ui:ToggleSwitch Name="MatchAccentColor" Toggled="MatchAccentColor_Toggled" />
                            </ui:SettingsCard>
                            <!--  Main color picker  -->
                            <ui:SettingsCard
                                d:Visibility="Visible"
                                Header="{l:Static resx:Resources.DevicePage_DynamicLighting_MainColorSelection}"
                                Visibility="{Binding Source={x:Reference LEDSettingsLevel}, Path=SelectedIndex, Converter={StaticResource IndexToVisibilityConverter}, ConverterParameter=0|1|3|5}">
                                <colorpicker:PortableColorPicker
                                    Name="MainColorPicker"
                                    Width="32"
                                    Height="31"
                                    ColorChanged="MainColorPicker_ColorChanged"
                                    Style="{StaticResource DefaultColorPickerStyle}" />
                            </ui:SettingsCard>
                            <!--  Use second color  -->
                            <ui:SettingsCard
                                Name="SecondColorToggleCard"
                                d:Visibility="Visible"
                                Header="{l:Static resx:Resources.DevicePage_UseSecondColor}"
                                Visibility="{Binding Source={x:Reference LEDSettingsLevel}, Path=SelectedIndex, Converter={StaticResource IndexToVisibilityConverter}, ConverterParameter=0|1}">
                                <ui:ToggleSwitch Name="Toggle_UseSecondColor" Toggled="Toggle_UseSecondColor_Toggled" />
                            </ui:SettingsCard>
                            <!--  Second color  -->
                            <ui:SettingsCard
                                Name="SecondColorPickerCard"
                                d:Visibility="Visible"
                                Header="{l:Static resx:Resources.DevicePage_DynamicLighting_SecondColorSelection}"
                                IsEnabled="{Binding Source={x:Reference Toggle_UseSecondColor}, Path=IsOn}"
                                Visibility="{Binding Source={x:Reference LEDSettingsLevel}, Path=SelectedIndex, Converter={StaticResource IndexToVisibilityConverter}, ConverterParameter=0|1}">
                                <colorpicker:PortableColorPicker
                                    Name="SecondColorPicker"
                                    Width="32"
                                    Height="31"
                                    ColorChanged="SecondColorPicker_ColorChanged"
                                    Style="{StaticResource DefaultColorPickerStyle}" />
                            </ui:SettingsCard>
                            <!--  Vertical blackbar detection  -->
                            <ui:SettingsCard
                                d:Visibility="Visible"
                                Header="{l:Static resx:Resources.DevicePage_AmbilightVerticalBlackBarDetectionDesc}"
                                Visibility="{Binding Source={x:Reference LEDSettingsLevel}, Path=SelectedIndex, Converter={StaticResource IndexToVisibilityConverter}, ConverterParameter=6}">
                                <ui:ToggleSwitch Name="Toggle_AmbilightVerticalBlackBarDetection" Toggled="Toggle_AmbilightVerticalBlackBarDetection_Toggled" />
                            </ui:SettingsCard>
                            <!--  OEM Presets  -->
                            <ui:SettingsCard
                                d:Visibility="Visible"
                                Header="{l:Static resx:Resources.DevicePage_DynamicLighting_PresetsSelection}"
                                Visibility="{Binding Source={x:Reference LEDSettingsLevel}, Path=SelectedIndex, Converter={StaticResource IndexToVisibilityConverter}, ConverterParameter=7}">
                                <ComboBox
                                    Name="LedPresetsComboBox"
                                    Grid.Column="1"
                                    Margin="12,0,0,0"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Center"
                                    SelectionChanged="LEDOEMPreset_SelectionChanged">
                                    <ComboBox.ItemTemplate>
                                        <ItemContainerTemplate>
                                            <WrapPanel>
                                                <Image
                                                    Width="25"
                                                    Height="25"
                                                    Source="{Binding IconPath}" />
                                                <TextBlock
                                                    Height="25"
                                                    Margin="10,6,0,0"
                                                    Text="{Binding DisplayName}" />
                                            </WrapPanel>
                                        </ItemContainerTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </ui:SettingsCard>
                        </ui:SettingsExpander.Items>
                    </ui:SettingsExpander>
                </ikw:SimpleStackPanel>
            </ikw:SimpleStackPanel>

            <!--  Sensor options  -->
            <TextBlock Style="{StaticResource BaseTextBlockStyle}" Text="{l:Static resx:Resources.SettingsPage_SensorOptions}" />
            <ikw:SimpleStackPanel Name="SensorOptionsStack" Spacing="3">
                <!--  Sensor Selection  -->
                <ui:SettingsCard
                    Name="SensorSelectionCard"
                    Description="{l:Static resx:Resources.SettingsPage_SensorSelectionDesc}"
                    Header="{l:Static resx:Resources.SettingsPage_SensorSelection}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xE950;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ComboBox Name="cB_SensorSelection" SelectionChanged="cB_SensorSelection_SelectionChanged">
                        <ComboBoxItem
                            Name="SensorNone"
                            Content="{l:Static resx:Resources.SettingsPage_SensorNone}"
                            IsEnabled="True" />
                        <ComboBoxItem
                            Name="SensorInternal"
                            Content="{l:Static resx:Resources.SettingsPage_SensorInternal}"
                            IsEnabled="False" />
                        <ComboBoxItem
                            Name="SensorExternal"
                            Content="{l:Static resx:Resources.SettingsPage_SensorExternal}"
                            IsEnabled="False" />
                        <ComboBoxItem
                            Name="SensorController"
                            Content="{l:Static resx:Resources.MainWindow_navController}"
                            IsEnabled="False" />
                    </ComboBox>
                </ui:SettingsCard>

                <!--  Sensor Calibration  -->
                <ui:SettingsCard Description="{l:Static resx:Resources.SettingsPage_SensorCalibrationDesc}" Header="{l:Static resx:Resources.SettingsPage_SensorCalibration}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xE950;" />
                    </ui:SettingsCard.HeaderIcon>
                    <Button
                        Name="ui_button_calibrate"
                        Click="ui_button_calibrate_Click"
                        Content="{l:Static resx:Resources.DevicePage_SensorCalibration_Button}"
                        FontSize="14"
                        Style="{DynamicResource AccentButtonStyle}" />
                </ui:SettingsCard>

                <!--  Sensor Placement Direction  -->
                <ui:SettingsCard
                    Name="SensorPlacementVisualisation"
                    Description="{l:Static resx:Resources.SettingsPage_SensorPlacementDirectionDesc}"
                    Header="{l:Static resx:Resources.SettingsPage_SensorPlacementDirection}"
                    Visibility="{Binding Source={x:Reference cB_SensorSelection}, Path=SelectedIndex, Converter={StaticResource IndexToVisibilityConverter}, ConverterParameter=2}">
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xE80A;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ikw:SimpleStackPanel
                        Name="Grid_SensorPlacementVisualisation"
                        HorizontalAlignment="Right"
                        IsEnabled="False"
                        Spacing="3">
                        <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="3">
                            <Button
                                Width="50"
                                Height="50"
                                Tag="99"
                                Visibility="Hidden" />
                            <Button
                                Width="50"
                                Height="50"
                                Click="SensorPlacement_Click"
                                Tag="0" />
                            <Button
                                Width="50"
                                Height="50"
                                Tag="99"
                                Visibility="Hidden" />
                        </ikw:SimpleStackPanel>
                        <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="3">
                            <Button
                                Width="50"
                                Height="50"
                                Click="SensorPlacement_Click"
                                Tag="1" />
                            <Button
                                Width="50"
                                Height="50"
                                Tag="99"
                                Visibility="Hidden" />
                            <Button
                                Width="50"
                                Height="50"
                                Click="SensorPlacement_Click"
                                Tag="2" />
                        </ikw:SimpleStackPanel>
                        <ikw:SimpleStackPanel Orientation="Horizontal" Spacing="3">
                            <Button
                                Width="50"
                                Height="50"
                                Tag="99"
                                Visibility="Hidden" />
                            <Button
                                Width="50"
                                Height="50"
                                Click="SensorPlacement_Click"
                                Tag="3" />
                            <Button
                                Width="50"
                                Height="50"
                                Tag="99"
                                Visibility="Hidden" />
                        </ikw:SimpleStackPanel>
                    </ikw:SimpleStackPanel>
                </ui:SettingsCard>
                <!--  Sensor Placement Mirror  -->
                <ui:SettingsCard
                    Name="SensorPlacementUpsideDown"
                    Description="{l:Static resx:Resources.SettingsPage_SensorPlacementUpsideDownDesc}"
                    Header="{l:Static resx:Resources.SettingsPage_SensorPlacementUpsideDown}">
                    <!--  Visibility="{Binding Source={x:Reference cB_SensorSelection}, Path=SelectedIndex, Converter={StaticResource IndexToVisibilityConverter}, ConverterParameter=2}"  -->
                    <ui:SettingsCard.HeaderIcon>
                        <ui:FontIcon Glyph="&#xE1CA;" />
                    </ui:SettingsCard.HeaderIcon>
                    <ui:ToggleSwitch
                        Name="Toggle_SensorPlacementUpsideDown"
                        IsEnabled="False"
                        Toggled="Toggle_SensorPlacementUpsideDown_Toggled" />
                </ui:SettingsCard>
            </ikw:SimpleStackPanel>

            <ikw:SimpleStackPanel Spacing="8">

                <!--  Device settings  -->
                <TextBlock
                    d:Text="Device settings (MSI Claw)"
                    Style="{StaticResource BaseTextBlockStyle}"
                    Text="{l:Static resx:Resources.DevicePage_DeviceSettings}"
                    Visibility="{Binding ElementName=MSIClawPanel, Path=Visibility}" />

                <!--  MSI Claw 8  -->
                <ikw:SimpleStackPanel
                    Name="MSIClawPanel"
                    d:Visibility="Visible"
                    Spacing="3"
                    Visibility="Collapsed">

                    <ui:SettingsCard Description="Select the desired controller mode" Header="Controller mode">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Glyph="&#xE7FC;" />
                        </ui:SettingsCard.HeaderIcon>

                        <ComboBox SelectedIndex="{Binding ClawControllerIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                            <ComboBoxItem Content="Offline" />
                            <ComboBoxItem Content="XInput" />
                            <ComboBoxItem Content="DirectInput" />
                        </ComboBox>
                    </ui:SettingsCard>

                    <ui:SettingsCard
                        Description="Maximize the combined performance of the processor and GPU"
                        Header="MSI OverBoost"
                        IsEnabled="{Binding HasOverBoost, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Glyph="&#xEC7A;" />
                        </ui:SettingsCard.HeaderIcon>

                        <ui:ToggleSwitch IsOn="{Binding ClawOverBoost, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                    </ui:SettingsCard>
                </ikw:SimpleStackPanel>

                <!--  Device settings  -->
                <TextBlock
                    d:Text="Device settings (Lenovo Legion Go)"
                    Style="{StaticResource BaseTextBlockStyle}"
                    Text="{l:Static resx:Resources.DevicePage_DeviceSettings}"
                    Visibility="{Binding ElementName=LegionGoPanel, Path=Visibility}" />

                <!--  Lenovo Legion Go  -->
                <ikw:SimpleStackPanel
                    Name="LegionGoPanel"
                    d:Visibility="Visible"
                    Spacing="3"
                    Visibility="Collapsed">

                    <ui:SettingsCard
                        Name="LegionGoPassthrough"
                        Description="{l:Static resx:Resources.ControllerPage_LegionGoPassthroughDesc}"
                        Header="{l:Static resx:Resources.ControllerPage_LegionGoPassthrough}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Glyph="&#xe772;" />
                        </ui:SettingsCard.HeaderIcon>
                        <ui:ToggleSwitch Name="Toggle_TouchpadPassthrough" Toggled="Toggle_TouchpadPassthrough_Toggled" />
                    </ui:SettingsCard>

                    <ui:SettingsCard
                        Name="LegionGoControllerSwap"
                        Description="{l:Static resx:Resources.ControllerPage_LegionGoControllerSwapDesc}"
                        Header="{l:Static resx:Resources.ControllerPage_LegionGoControllerSwap}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Glyph="&#xe772;" />
                        </ui:SettingsCard.HeaderIcon>
                        <ui:ToggleSwitch Name="Toggle_ControllerSwap" Toggled="Toggle_ControllerSwap_Toggled" />
                    </ui:SettingsCard>

                    <ui:SettingsCard
                        Name="LegionGoSensorSelection"
                        d:Visibility="Visible"
                        Description="{l:Static resx:Resources.SettingsPage_SensorSelectionDesc}"
                        Header="{l:Static resx:Resources.SettingsPage_SensorSelection}"
                        Visibility="Collapsed">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Glyph="&#xE950;" />
                        </ui:SettingsCard.HeaderIcon>

                        <ComboBox Name="ComboBox_GyroController" SelectionChanged="ComboBox_GyroController_SelectionChanged">
                            <ComboBoxItem Content="{l:Static resx:Resources.DevicePage_Lenovo_LeftController}" />
                            <ComboBoxItem Content="{l:Static resx:Resources.DevicePage_Lenovo_RightController}" />
                        </ComboBox>
                    </ui:SettingsCard>

                    <ui:SettingsExpander
                        Name="LegionGoLeftController"
                        d:Visibility="Visible"
                        Description="{l:Static resx:Resources.DevicePage_Lenovo_ControllerLeftDesc}"
                        Expanded="Expander_Expanded"
                        Header="{l:Static resx:Resources.DevicePage_Lenovo_ControllerLeft}"
                        Visibility="Collapsed">
                        <ui:SettingsExpander.HeaderIcon>
                            <ui:FontIcon Glyph="&#xE7FC;" />
                        </ui:SettingsExpander.HeaderIcon>
                        <ui:SettingsExpander.Items>
                            <!--  Left Joycon Sleep Time  -->
                            <ui:SettingsCard d:Visibility="Visible" Header="{l:Static resx:Resources.DevicePage_Lenovo_ControllerAutoSleepTime}">
                                <DockPanel>
                                    <Label
                                        VerticalAlignment="Center"
                                        Content="{Binding Value, StringFormat={}{0:N0}min, Source={x:Reference SliderLeftAutoSleepTime}, Mode=OneWay}"
                                        Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" />
                                    <Slider
                                        Name="SliderLeftAutoSleepTime"
                                        Width="200"
                                        Margin="6,0,0,0"
                                        VerticalAlignment="Center"
                                        IsMoveToPointEnabled="True"
                                        IsSnapToTickEnabled="True"
                                        LargeChange="5"
                                        Maximum="60"
                                        Minimum="1"
                                        SmallChange="1"
                                        ToolTip="{Binding Value, StringFormat=N0, RelativeSource={RelativeSource Self}, Mode=OneWay}"
                                        ValueChanged="SliderLeftAutoSleepTime_ValueChanged" />
                                </DockPanel>
                            </ui:SettingsCard>
                            <!--  Left Joystick deadzone  -->
                            <ui:SettingsCard d:Visibility="Visible" Header="{l:Static resx:Resources.DevicePage_Lenovo_ControllerJoystickDeadzone}">
                                <DockPanel>
                                    <Label
                                        VerticalAlignment="Center"
                                        Content="{Binding Value, StringFormat={}{0:N0}%, Source={x:Reference SliderLeftJoystickDeadzone}, Mode=OneWay}"
                                        Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" />
                                    <Slider
                                        Name="SliderLeftJoystickDeadzone"
                                        Width="200"
                                        Margin="6,0,0,0"
                                        VerticalAlignment="Center"
                                        IsMoveToPointEnabled="True"
                                        IsSnapToTickEnabled="True"
                                        LargeChange="5"
                                        Maximum="100"
                                        Minimum="1"
                                        SmallChange="1"
                                        ToolTip="{Binding Value, StringFormat=N0, RelativeSource={RelativeSource Self}, Mode=OneWay}"
                                        ValueChanged="SliderLeftJoystickDeadzone_ValueChanged" />
                                </DockPanel>
                            </ui:SettingsCard>
                            <!--  Left Trigger deadzone  -->
                            <ui:SettingsCard d:Visibility="Visible" Header="{l:Static resx:Resources.DevicePage_Lenovo_ControllerTriggerDeadzone}">
                                <DockPanel>
                                    <Label
                                        VerticalAlignment="Center"
                                        Content="{Binding Value, StringFormat={}{0:N0}%, Source={x:Reference SliderLeftTriggerDeadzone}, Mode=OneWay}"
                                        Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" />
                                    <Slider
                                        Name="SliderLeftTriggerDeadzone"
                                        Width="200"
                                        Margin="6,0,0,0"
                                        VerticalAlignment="Center"
                                        IsMoveToPointEnabled="True"
                                        IsSnapToTickEnabled="True"
                                        LargeChange="5"
                                        Maximum="{Binding Source={x:Reference SliderLeftTriggerMargin}, Path=Value, Converter={StaticResource InvertPercentageConverter}}"
                                        Minimum="1"
                                        SmallChange="1"
                                        ToolTip="{Binding Value, StringFormat=N0, RelativeSource={RelativeSource Self}, Mode=OneWay}"
                                        ValueChanged="SliderLeftTriggerDeadzone_ValueChanged"
                                        Value="{Binding LeftTriggerDeadzoneValue}" />
                                </DockPanel>
                            </ui:SettingsCard>
                            <!--  Left Trigger margin  -->
                            <ui:SettingsCard d:Visibility="Visible" Header="{l:Static resx:Resources.DevicePage_Lenovo_ControllerTriggerMargin}">
                                <DockPanel>
                                    <Label
                                        VerticalAlignment="Center"
                                        Content="{Binding Value, StringFormat={}{0:N0}%, Source={x:Reference SliderLeftTriggerMargin}, Mode=OneWay}"
                                        Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" />
                                    <Slider
                                        Name="SliderLeftTriggerMargin"
                                        Width="200"
                                        Margin="6,0,0,0"
                                        VerticalAlignment="Center"
                                        IsMoveToPointEnabled="True"
                                        IsSnapToTickEnabled="True"
                                        LargeChange="5"
                                        Maximum="{Binding LeftTriggerDeadzoneValue, Converter={StaticResource InvertPercentageConverter}}"
                                        Minimum="1"
                                        SmallChange="1"
                                        ToolTip="{Binding Value, StringFormat=N0, RelativeSource={RelativeSource Self}, Mode=OneWay}"
                                        ValueChanged="SliderLeftTriggerMargin_ValueChanged" />
                                </DockPanel>
                            </ui:SettingsCard>
                        </ui:SettingsExpander.Items>
                    </ui:SettingsExpander>

                    <!--  Right Joycon  -->
                    <ui:SettingsExpander
                        Name="LegionGoRightController"
                        d:Visibility="Visible"
                        Description="{l:Static resx:Resources.DevicePage_Lenovo_ControllerRightDesc}"
                        Expanded="Expander_Expanded"
                        Header="{l:Static resx:Resources.DevicePage_Lenovo_ControllerRight}"
                        Visibility="Collapsed">
                        <ui:SettingsExpander.HeaderIcon>
                            <ui:FontIcon Glyph="&#xE7FC;" />
                        </ui:SettingsExpander.HeaderIcon>
                        <ui:SettingsExpander.Items>
                            <!--  Right Joycon Sleep Time  -->
                            <ui:SettingsCard d:Visibility="Visible" Header="{l:Static resx:Resources.DevicePage_Lenovo_ControllerAutoSleepTime}">
                                <DockPanel>
                                    <Label
                                        VerticalAlignment="Center"
                                        Content="{Binding Value, StringFormat={}{0:N0}min, Source={x:Reference SliderRightAutoSleepTime}, Mode=OneWay}"
                                        Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" />
                                    <Slider
                                        Name="SliderRightAutoSleepTime"
                                        Width="200"
                                        Margin="6,0,0,0"
                                        VerticalAlignment="Center"
                                        IsMoveToPointEnabled="True"
                                        IsSnapToTickEnabled="True"
                                        LargeChange="5"
                                        Maximum="60"
                                        Minimum="1"
                                        SmallChange="1"
                                        ToolTip="{Binding Value, StringFormat=N0, RelativeSource={RelativeSource Self}, Mode=OneWay}"
                                        ValueChanged="SliderRightAutoSleepTime_ValueChanged" />
                                </DockPanel>
                            </ui:SettingsCard>
                            <!--  Right Joystick deadzone  -->
                            <ui:SettingsCard d:Visibility="Visible" Header="{l:Static resx:Resources.DevicePage_Lenovo_ControllerJoystickDeadzone}">
                                <DockPanel>
                                    <Label
                                        VerticalAlignment="Center"
                                        Content="{Binding Value, StringFormat={}{0:N0}%, Source={x:Reference SliderRightJoystickDeadzone}, Mode=OneWay}"
                                        Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" />
                                    <Slider
                                        Name="SliderRightJoystickDeadzone"
                                        Width="200"
                                        Margin="6,0,0,0"
                                        VerticalAlignment="Center"
                                        IsMoveToPointEnabled="True"
                                        IsSnapToTickEnabled="True"
                                        LargeChange="5"
                                        Maximum="100"
                                        Minimum="1"
                                        SmallChange="1"
                                        ToolTip="{Binding Value, StringFormat=N0, RelativeSource={RelativeSource Self}, Mode=OneWay}"
                                        ValueChanged="SliderRightJoystickDeadzone_ValueChanged" />
                                </DockPanel>
                            </ui:SettingsCard>
                            <!--  Right Trigger deadzone  -->
                            <ui:SettingsCard d:Visibility="Visible" Header="{l:Static resx:Resources.DevicePage_Lenovo_ControllerTriggerDeadzone}">
                                <DockPanel>
                                    <Label
                                        VerticalAlignment="Center"
                                        Content="{Binding Value, StringFormat={}{0:N0}%, Source={x:Reference SliderRightTriggerDeadzone}, Mode=OneWay}"
                                        Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" />
                                    <Slider
                                        Name="SliderRightTriggerDeadzone"
                                        Width="200"
                                        Margin="6,0,0,0"
                                        VerticalAlignment="Center"
                                        IsMoveToPointEnabled="True"
                                        IsSnapToTickEnabled="True"
                                        LargeChange="5"
                                        Maximum="{Binding Source={x:Reference SliderRightTriggerMargin}, Path=Value, Converter={StaticResource InvertPercentageConverter}}"
                                        Minimum="1"
                                        SmallChange="1"
                                        ToolTip="{Binding Value, StringFormat=N0, RelativeSource={RelativeSource Self}, Mode=OneWay}"
                                        ValueChanged="SliderRightTriggerDeadzone_ValueChanged"
                                        Value="{Binding RightTriggerDeadzoneValue}" />
                                </DockPanel>
                            </ui:SettingsCard>
                            <!--  Right Trigger margin  -->
                            <ui:SettingsCard d:Visibility="Visible" Header="{l:Static resx:Resources.DevicePage_Lenovo_ControllerTriggerMargin}">
                                <DockPanel>
                                    <Label
                                        VerticalAlignment="Center"
                                        Content="{Binding Value, StringFormat={}{0:N0}%, Source={x:Reference SliderRightTriggerMargin}, Mode=OneWay}"
                                        Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}" />
                                    <Slider
                                        Name="SliderRightTriggerMargin"
                                        Width="200"
                                        Margin="6,0,0,0"
                                        VerticalAlignment="Center"
                                        IsMoveToPointEnabled="True"
                                        IsSnapToTickEnabled="True"
                                        LargeChange="5"
                                        Maximum="{Binding RightTriggerDeadzoneValue, Converter={StaticResource InvertPercentageConverter}}"
                                        Minimum="1"
                                        SmallChange="1"
                                        ToolTip="{Binding Value, StringFormat=N0, RelativeSource={RelativeSource Self}, Mode=OneWay}"
                                        ValueChanged="SliderRightTriggerMargin_ValueChanged" />
                                </DockPanel>
                            </ui:SettingsCard>
                        </ui:SettingsExpander.Items>
                    </ui:SettingsExpander>
                </ikw:SimpleStackPanel>

                <!--  Device settings  -->
                <TextBlock
                    d:Text="Device settings (Zotac Gaming Zone)"
                    Style="{StaticResource BaseTextBlockStyle}"
                    Text="{l:Static resx:Resources.DevicePage_DeviceSettings}"
                    Visibility="{Binding ElementName=LegionGoPanel, Path=Visibility}" />

                <!--  Zotac Gaming Zone  -->
                <ikw:SimpleStackPanel
                    Name="ZotacGamingZonePanel"
                    d:Visibility="Visible"
                    Spacing="3"
                    Visibility="Collapsed">

                    <ui:SettingsCard Description="{l:Static resx:Resources.DevicePage_GamingZone_VRAMDesc}" Header="{l:Static resx:Resources.DevicePage_GamingZone_VRAM}">
                        <ui:SettingsCard.HeaderIcon>
                            <ui:FontIcon Glyph="&#xe772;" />
                        </ui:SettingsCard.HeaderIcon>

                        <ComboBox Name="ComboBox_GamingZoneVRAM" SelectionChanged="ComboBox_GamingZoneVRAM_SelectionChanged">
                            <ComboBoxItem Content="Default" />
                            <ComboBoxItem Content="+1 GB" />
                            <ComboBoxItem Content="+2 GB" />
                            <ComboBoxItem Content="+3 GB" />
                            <ComboBoxItem Content="+4 GB" />
                        </ComboBox>
                    </ui:SettingsCard>
                </ikw:SimpleStackPanel>

            </ikw:SimpleStackPanel>
        </ikw:SimpleStackPanel>
    </Grid>
</Page>